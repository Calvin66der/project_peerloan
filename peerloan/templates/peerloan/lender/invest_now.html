<!DOCTYPE html><!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]--><!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]--><!--[if !IE]><!-->{% load i18n %}{% language lang %}<html lang="en">    <!-- BEGIN HEAD -->    <head>        <meta charset="utf-8" />        <title>{% trans "Zwap" %}</title>        <meta http-equiv="X-UA-Compatible" content="IE=edge">        <meta content="width=device-width, initial-scale=1" name="viewport" />        <meta content="" name="description" />        <meta content="" name="author" />        {% load staticfiles %}        {% load my_tags %}        <script src="//code.jquery.com/jquery-1.10.2.js"></script>        <script>		$(function(){		  $("#header").load("/header/{{cate}}/{{sub_cate}}", function(){Layout.init()}); 		  $("#footer").load("/footer"); 		});		</script>        <!-- BEGIN GLOBAL MANDATORY STYLES -->        <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700&subset=all" rel="stylesheet" type="text/css" />        <link href="{% static 'peerloan/global/plugins/font-awesome/css/font-awesome.min.css' %}" rel="stylesheet" type="text/css" />        <link href="{% static 'peerloan/global/plugins/simple-line-icons/simple-line-icons.min.css' %}" rel="stylesheet" type="text/css" />        <link href="{% static 'peerloan/global/plugins/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet" type="text/css" />        <link href="{% static 'peerloan/global/plugins/uniform/css/uniform.default.css' %}" rel="stylesheet" type="text/css" />        <link href="{% static 'peerloan/global/plugins/bootstrap-switch/css/bootstrap-switch.min.css' %}" rel="stylesheet" type="text/css" />        <!-- END GLOBAL MANDATORY STYLES -->        <!-- BEGIN PAGE LEVEL PLUGINS -->        <link href="{% static 'peerloan/global/plugins/ion.rangeslider/css/ion.rangeSlider.css' %}" rel="stylesheet" id="style_components" type="text/css" />        <link href="{% static 'peerloan/global/plugins/ion.rangeslider/css/ion.rangeSlider.skinFlat.css' %}" rel="stylesheet" type="text/css" />        <!-- END PAGE LEVEL PLUGINS -->        <!-- BEGIN THEME GLOBAL STYLES -->        <link href="{% static 'peerloan/global/css/components.min.css' %}" rel="stylesheet" id="style_components" type="text/css" />        <link href="{% static 'peerloan/global/css/plugins.min.css' %}" rel="stylesheet" type="text/css" />        <!-- END THEME GLOBAL STYLES -->        <!-- BEGIN THEME LAYOUT STYLES -->        <link href="{% static 'peerloan/layouts/layout3/css/layout.css' %}" rel="stylesheet" type="text/css" />        <link href="{% static 'peerloan/layouts/layout3/css/themes/default.min.css' %}" rel="stylesheet" type="text/css" id="style_color" />        <link href="{% static 'peerloan/layouts/layout3/css/custom.min.css' %}" rel="stylesheet" type="text/css" />        <!-- END THEME LAYOUT STYLES -->        <link rel="shortcut icon" href="{% static 'favicon.ico' %}" />        <style>			.loader {				color: #B6294D ! important;			}			.tooltip.top {			width: 200px !important;			}			.irs-bar,.irs-from, .irs-to, .irs-single {		            background: #03ACC8;		        }		</style>    </head>    <!-- END HEAD -->    <body class="page-container-bg-solid page-boxed">        <!-- BEGIN HEADER -->		<div id="header"></div>		<!-- END HEADER -->        <!-- BEGIN CONTAINER -->        <div class="page-container">            <!-- BEGIN CONTENT -->            <div class="page-content-wrapper">            	<!-- BEGIN PAGE HEAD-->                <div class="page-head">                    <div class="container">                        <!-- BEGIN PAGE TITLE -->                        <div class="page-title">                            <h1>{{title}}</h1>                        </div>                        <!-- END PAGE TITLE -->                    </div>                </div>                <!-- END PAGE HEAD-->                <!-- BEGIN CONTENT BODY -->                <!-- BEGIN PAGE CONTENT BODY -->                <div class="page-content">                    <div class="container">                        <!-- BEGIN PAGE CONTENT INNER -->                        <div class="page-content-inner">                            <div class="row">                                <div class="col-md-12">                                    <!-- BEGIN VALIDATION STATES-->                                    <div class="portlet light">                                        <div class="portlet-body form">                                            <!-- BEGIN FORM PREFACE-->                                            <form validate action="/ack/" class="form-horizontal" method="post" enctype="multipart/form-data">                                            	{% csrf_token %}                                            	<div class="form-body">                                            		<h4 class="form-section"><strong>{% trans "Allocate Fund to Product" %}</strong></h4>                                            		<div class="form-group">                                            			<label class="col-md-3 control-label" style="text-align:left;">{% trans "Account Balance" %}:</label>                                            			<div class="col-md-3">                                            				<p class="form-control-static">HK${{str_account_balance}}</p>                                            			</div>                                            		</div>                                            		<div class="form-group">                                            			<label class="col-md-3 control-label" style="text-align:left;">{% trans "Available Amount" %}:</label>                                            			<div class="col-md-3">                                            				<p class="form-control-static">HK${{str_unallocated}}</p>                                            			</div>                                            		</div>                                            		<h4 class="form-section"></h4>                                            		<div class="form-group">                                            			<div class="col-md-5">                                            				<div class="input-group">				                                        		<span class="input-group-addon" style="background-color: #03ACC8;color: #fff;">				                                        			{% trans "Product" %}				                                        		</span>				                                        		<select class="form-control select2" name="prod_id" id="prod_id">	                                            					{% for prod in prod_list %}	                                            					<option value="{{prod.id}}">	                                            					{% if lang == 'en' %}	                                            					{{prod.name_en}}	                                            					{% elif lang == 'zh' %}	                                            					{{prod.name_zh}}	                                            					{% endif %}	                                            					</option>	                                            						                                            					{% endfor %}					                                        	</select>				                                        	</div>                                            			</div>                                            			<div class="col-md-3">&nbsp;</div>                                            			<div class="col-md-4">                                            				<a href='javascript:window.open("/investment/invest_now/product_details/","contestrules", "menubar=0,resizable=0,width=1000,height=800");'><button type="button" class="btn green-jungle">{% trans "Details" %}</button></a>                                            			</div>                                            		</div>                                            		<div class="form-group">                                            			<label class="col-md-3 control-label" style="text-align:left;">{% trans "Queuing Amount in This Product" %}:</label>                                            			<div class="col-md-3">                                            				<p class="form-control-static" id="existed_investment"></p>                                            			</div>                                            		</div>                                            		<div class="form-group">                                            			<label class="col-md-3 control-label" style="text-align:left;">{% trans "Returning Principal of This Product" %}                                            			:</label>                                            			<div class="col-md-3">                                            				<p class="form-control-static" id="on_hold_investment"></p>                                            			</div>                                            		</div>                                            		<div class="form-group">                                            			<label class="col-md-3 control-label" style="text-align:left;">{% trans "Investment Amount" %} <span class="required"> * </span>:</label>                                            			<div class="col-md-3">                                            				<p class="form-control-static" id="ion_investment_amt"></p>                                            			</div>                                            			<div class="col-md-6">                                            				<input id="inv_amt_bar" type="text" name="investment_amount" value="" required="required" />                                            				<p class="form-control-static" id="inv_amt_p"></p>                                            			</div>                                            		</div>                                            		<div class="form-group">                                                        <label class="col-md-3 control-label" style="text-align:left;">{% trans "Maximum Investment Amount Per Loan" %}<span class="required"> * </span>:</label>                                                        <div class="col-md-3">                                            				<p class="form-control-static" id="ion_max_amt_per_loan"></p>                                            			</div>                                                        <div class="col-md-6">                                                            <input id="max_amt_loan_bar" type="text" name="max_amount_per_loan" value="" required="required" />                                                        </div>                                                	</div>                                            		<div class="form-group">                                            			<label class="col-md-3 control-label" style="text-align:left;">{% trans "Reinvest Setting" %} <span class="required"> * </span>                                            			<i class="fa fa-question-circle tooltips" data-original-title="{% trans 'Repayment from this product will be reinvest to the same product' %}"></i>                                            			:</label>                                            			<div class="col-md-2">                                            				<select class="bs-select form-control" name="investment_setting" required />                                    							<option value="Reinvest">{% trans "Yes" %}</option>                                    							<option value="Not Reinvest">{% trans "No" %}</option>                                    						</select>                                                        </div>                                            		</div>                                                </div>                                                <div class="form-actions">                                                    <div class="row">                                                        <div class="col-md-offset-10 col-md-2">                                                            <button type="submit" class="btn green-jungle" id="invest_now">{% trans "Invest Now" %}</button>                                                        	                                                        </div>                                                    </div>                                                </div>                                            </form>                                            <!-- END FORM PREFACE-->                                        </div>                                    </div>                                    <!-- END VALIDATION STATES-->                                                                        <div class="portlet light">                                    	<div class="portlet-body form">                                    		<div class="form-body">                                    			<h4 class="form-section" style="border-bottom:0px;">                                    				<div class="col-md-4">                                    					<strong>{% trans "Overall Investment Distribution" %}</strong>                                    				</div>                                    				<div class="col-md-4">&nbsp;</div>	                                    			<div class="input-group col-md-4" style="float:right;margin-top:-10px !important">		                                        		<span class="input-group-addon" style="background-color: #03ACC8;color: #fff;">		                                        			{% trans "Product" %}		                                        		</span>		                                        		<select id="pie_prod" class="form-control select2" onchange="get_selected_pie_prod();">			                                        		<option value="all">{% trans "All Products" %}</option>			                                        		{% for prod in prod_list %}			                                        		{% if lang == 'en' %}			                                        		<option value="{{prod.id}}">{{prod.name_en}}</option>			                                        		{% elif lang == 'zh' %}			                                        		<option value="{{prod.id}}">{{prod.name_zh}}</option>			                                        		{% endif %}			                                        		{% endfor %}			                                        	</select>		                                        	</div>                                    			</h4>                                    			<div class="row">                                    				<div class="col-md-5">                                    					<h4 class="form-section">{% trans "Distribution of Account Balance" %}</h4>														<div id="echarts_pie_repay" style="height:400px;"></div>																											</div>													<div class="col-md-2"></div>													<div class="col-md-5">														<h4 class="form-section">{% trans "Distribution of Investment Return" %}</h4>														<div id="echarts_pie_repay2" style="height:400px;"></div>													</div>                                    			</div>                                    		</div>                                    	</div>                                    </div>                                </div>                            </div>                        </div>                        <!-- END PAGE CONTENT INNER -->                    </div>                </div>                <!-- END PAGE CONTENT BODY -->                <!-- END CONTENT BODY -->            </div>            <!-- END CONTENT -->        </div>        <!-- END CONTAINER -->        <!-- BEGIN FOOTER -->        <div id="footer"></div>        <!-- END FOOTER -->        <!--[if lt IE 9]><script src="../assets/global/plugins/respond.min.js"></script><script src="../assets/global/plugins/excanvas.min.js"></script> <![endif]-->        <!-- BEGIN CORE PLUGINS -->        <script src="{% static 'peerloan/global/plugins/jquery.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/bootstrap/js/bootstrap.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/js.cookie.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/bootstrap-hover-dropdown/bootstrap-hover-dropdown.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/jquery-slimscroll/jquery.slimscroll.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/jquery.blockui.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/uniform/jquery.uniform.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/bootstrap-switch/js/bootstrap-switch.min.js' %}" type="text/javascript"></script>        <!-- END CORE PLUGINS -->        <!-- BEGIN PAGE LEVEL PLUGINS -->        <script src="{% static 'peerloan/global/plugins/ion.rangeslider/js/ion.rangeSlider.min.js' %}" type="text/javascript"></script>        <!-- END PAGE LEVEL PLUGINS -->        <!-- BEGIN THEME GLOBAL SCRIPTS -->        <script src="{% static 'peerloan/global/scripts/app.min.js' %}" type="text/javascript"></script>        <!-- END THEME GLOBAL SCRIPTS -->        <!-- BEGIN PAGE LEVEL SCRIPTS -->        <script src="{% static 'peerloan/pages/scripts/components-ion-sliders.min.js' %}" type="text/javascript"></script>        <!-- END PAGE LEVEL SCRIPTS -->        <!-- BEGIN THEME LAYOUT SCRIPTS -->        <script src="{% static 'peerloan/layouts/layout3/scripts/layout.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/layouts/layout3/scripts/demo.min.js' %}" type="text/javascript"></script>        <!-- END THEME LAYOUT SCRIPTS -->        <!-- BEGIN BAIDU ECHARTS SCRIPTS -->		<script src="{% static 'peerloan/global/plugins/echarts/echarts.js' %}" type="text/javascript"></script>        <!-- END BAIDU ECHARTS SCRIPTS -->    </body><script type="text/javascript" language="javascript" class="init">$('form').submit(function(e){    $(this).find('button[type=submit]').attr('disabled', 'disabled');    });var selected_prod,	prods = {{prod_list|safe}},	unallocated = {{unallocated}},	slider,	slider_2;function update_ionRangeSlider() {	slider && slider.destroy();	selected_prod = document.getElementById('prod_id').value;	for(i=0;i<prods.length;i++) {		if (prods[i]["id"] == selected_prod) {			var vals = [];			for(j=0;j<=unallocated/prods[i]["min_amount_per_loan"];j++) {				vals.push(j*prods[i]["min_amount_per_loan"]);			}			if (vals.length == 1) {				document.getElementById("invest_now").disabled = true;				$("#inv_amt_bar").hide();				$("#inv_amt_p").show();								{% if lang == 'en' %}				$("#inv_amt_p").html('Not sufficient fund, please <a href="/my_account/deposit_money" target="_blank">deposit money</a> first');				{% elif lang == 'zh' %}				$("#inv_amt_p").html('資金不足, 請先<a href="/my_account/deposit_money" target="_blank">存入資金</a>');				{% endif %}								$("#ion_investment_amt").html('HK$0.00');			} else {				document.getElementById("invest_now").disabled = false;				$("#inv_amt_p").hide();				$("#inv_amt_bar").ionRangeSlider({			        type: "double",			        values: vals,			        from: 0,			        from_fixed:true,			        to: unallocated/prods[i]["min_amount_per_loan"],			        to_min: 1,			        prefix: "HK$",			        onStart: function (data) {				        $("#ion_investment_amt").html('HK$'+data.to_value.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,'));				    },				    onChange: function (data) {				        $("#ion_investment_amt").html('HK$'+data.to_value.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,'));				    },				    onFinish: function (data) {				        $("#ion_investment_amt").html('HK$'+data.to_value.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,'));				    },				    onUpdate: function (data) {				        $("#ion_investment_amt").html('HK$'+data.to_value.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,'));				    }			    });			}		}	}	slider = $("#inv_amt_bar").data("ionRangeSlider");		slider_2 && slider_2.destroy();	//selected_prod = document.getElementById('prod_id').value;	for(i=0;i<prods.length;i++) {		if (prods[i]["id"] == selected_prod) {			var vals = [];			for(j=0;j<=prods[i]["total_amount"]/prods[i]["min_amount_per_loan"];j++) {				vals.push(j*prods[i]["min_amount_per_loan"]);			}			if (vals.length == 1) {				$("#max_amt_loan_bar").hide();			} else {				$("#max_amt_loan_bar").ionRangeSlider({			        type: "double",			        values: vals,			        from: 0,			        from_fixed:true,			        to: prods[i]["total_amount"]/prods[i]["min_amount_per_loan"],			        to_min: 1,			        prefix: "HK$",			        onStart: function (data) {				        $("#ion_max_amt_per_loan").html('HK$'+data.to_value.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,'));				    },				    onChange: function (data) {				        $("#ion_max_amt_per_loan").html('HK$'+data.to_value.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,'));				        				    },				    onFinish: function (data) {				        $("#ion_max_amt_per_loan").html('HK$'+data.to_value.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,'));				    },				    onUpdate: function (data) {				        $("#ion_max_amt_per_loan").html('HK$'+data.to_value.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,'));				    }			    });			}		}	}	slider_2 = $("#max_amt_loan_bar").data("ionRangeSlider");};function update_ajax_data() {	for(i=0;i<prods.length;i++) {		if (prods[i]["id"] == selected_prod) {			$("#existed_investment").html('HK$'+prods[i]["str_existed_investment"]);			$("#on_hold_investment").html('HK$'+prods[i]["str_on_hold_investment"]);			/*if (prods[i]["max_amt_per_loan"] == 'Not set') {				$("#max_amt_per_loan").html(prods[i]["max_amt_per_loan"]);			} else {				$("#max_amt_per_loan").html('HK$'+prods[i]["max_amt_per_loan"]);			}*/		}	}}$(document).ready(function() {update_ionRangeSlider();update_ajax_data();} );$('#prod_id').change( function() {	update_ionRangeSlider();	update_ajax_data();});</script><script type="text/javascript" language="javascript" class="init">var selected_pie_prod = document.getElementById('pie_prod').value;var name_list = [];var data_list = [];var color_list = [];var option = {    tooltip : {        trigger: 'item',        formatter: "{a} <br/>{b} : {c} ({d}%)"    },    legend : {        orient : 'vertical',        x : 'left',        data:[]    },    series : [        {            name:'Source',            type:'pie',            center : ['50%', '60%'],            radius : '55%',            itemStyle : {            	                normal : {                	color: function(params) {                        // build a color map as your need.                        //return color_list[params.dataIndex]                    },                    label: { show: false },                    labelLine: { show: false },                },            },                        data:[]        }    ]}function get_selected_pie_prod(){	selected_pie_prod = document.getElementById('pie_prod').value;}function update_pie_echart() {	// ECHARTS    require.config({        paths: {            echarts: "/static/peerloan/global/plugins/echarts/"        }    });    // DEMOS    require(        [            'echarts',            'echarts/chart/pie',        ],		function(ec) {			// -- PIE --            var myChartpie = ec.init(document.getElementById('echarts_pie_repay'));            $.ajax({				type: "get",				async: false,				url: "/allocatedinv_list_json/?prod_id="+selected_pie_prod,				dataType: "json",				success: function (result) {					if (result) {						name_list = [];						data_list = [];						color_list = [];						for (object in result.data)						{							if (result.data[object].name.indexOf('Total') > -1) { continue; }							//if (result.data[object].amount == 0) { continue; }							name_list.push(result.data[object].name)							data_list.push({value:result.data[object].amount, name:result.data[object].name});							color_list.push(result.data[object].color)						}					}					else {						alert("Error: Result not find");					}				},				error: function (errorMsg) {					alert("Error: Loading JSON");				}			});						option.legend.data=name_list;			option.series[0].data=data_list;			myChartpie.setOption(option);        }    );}function update_pie_echart2() {	// ECHARTS    require.config({        paths: {            echarts: "/static/peerloan/global/plugins/echarts/"        }    });    // DEMOS    require(        [            'echarts',            'echarts/chart/pie',        ],		function(ec) {			// -- PIE --            var myChartpie2 = ec.init(document.getElementById('echarts_pie_repay2'));            $.ajax({				type: "get",				async: false,				url: "/investedinv_list_json/?prod_id="+selected_pie_prod,				dataType: "json",				success: function (result) {					if (result) {						name_list = [];						data_list = [];						color_list = [];						for (object in result.data)						{							//if (result.data[object].amount == 0) { continue; }							name_list.push(result.data[object].name)							data_list.push({value:result.data[object].amount, name:result.data[object].name});							color_list.push(result.data[object].color)						}					}					else {						alert("Error: Result not find");					}				},				error: function (errorMsg) {					alert("Error: Loading JSON");				}			});						option.legend.data=name_list;			option.series[0].data=data_list;			myChartpie2.setOption(option);        }    );}$(document).ready(function() {	update_pie_echart();	update_pie_echart2();});$('#pie_prod').change(function() {	update_pie_echart();	update_pie_echart2();});</script></html>{% endlanguage %}{% load google_analytics_tags %}<div style="display:none">    <img src="{% google_analytics %}" width="0" height="0" /></div>