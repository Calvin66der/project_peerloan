<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
{% load i18n %}
{% language lang %}
<html lang="en">
    <!-- BEGIN HEAD -->
    <head>
        <meta charset="utf-8" />
        <title>{% trans "Peerloan" %}</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta content="width=device-width, initial-scale=1" name="viewport" />
        <meta content="" name="description" />
        <meta content="" name="author" />
        {% load staticfiles %}
        <script src="//code.jquery.com/jquery-1.10.2.js"></script>
        <script>
		$(function(){
		  $("#header").load("/header/{{cate}}/{{sub_cate}}", function(){Layout.init()}); 
		  $("#footer").load("/footer"); 
		});
		</script> 
		<style>
			.page-content {
				background: #5F9C50 !important;
			}
		</style>
        <!-- BEGIN GLOBAL MANDATORY STYLES -->
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700&subset=all" rel="stylesheet" type="text/css" />
        <link href="{% static 'peerloan/global/plugins/font-awesome/css/font-awesome.min.css' %}" rel="stylesheet" type="text/css" />
        <link href="{% static 'peerloan/global/plugins/simple-line-icons/simple-line-icons.min.css' %}" rel="stylesheet" type="text/css" />
        <link href="{% static 'peerloan/global/plugins/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet" type="text/css" />
        <link href="{% static 'peerloan/global/plugins/uniform/css/uniform.default.css' %}" rel="stylesheet" type="text/css" />
        <link href="{% static 'peerloan/global/plugins/bootstrap-switch/css/bootstrap-switch.min.css' %}" rel="stylesheet" type="text/css" />
        <!-- END GLOBAL MANDATORY STYLES -->
        <link href="{% static 'peerloan/global/plugins/datatables/datatables.min.css' %}" rel="stylesheet" type="text/css" />
        <link href="{% static 'peerloan/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.css' %}" rel="stylesheet" type="text/css" />
        <link href="{% static 'peerloan/global/plugins/bootstrap-datepicker/css/bootstrap-datepicker3.min.css' %}" rel="stylesheet" type="text/css" />
        <!-- END PAGE LEVEL PLUGINS -->
        <!-- BEGIN THEME GLOBAL STYLES -->
        <link href="{% static 'peerloan/global/css/components.css' %}" rel="stylesheet" id="style_components" type="text/css" />
        <link href="{% static 'peerloan/global/css/plugins.min.css' %}" rel="stylesheet" type="text/css" />
        <!-- END THEME GLOBAL STYLES -->
        <!-- BEGIN THEME LAYOUT STYLES -->
        <link href="{% static 'peerloan/layouts/layout3/css/layout.css' %}" rel="stylesheet" type="text/css" />
        <link href="{% static 'peerloan/layouts/layout3/css/themes/default.min.css' %}" rel="stylesheet" type="text/css" id="style_color" />
        <link href="{% static 'peerloan/layouts/layout3/css/custom.min.css' %}" rel="stylesheet" type="text/css" />
        <!-- END THEME LAYOUT STYLES -->
        <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
        <link rel="shortcut icon" href="{% static 'favicon.ico' %}" />
    </head>
    <!-- END HEAD -->

    <body class="page-container-bg-solid page-boxed">
        <!-- BEGIN HEADER -->
        <div id="header"></div>
        <!-- END HEADER -->
        <!-- BEGIN CONTAINER -->
        <div class="page-container">
            <!-- BEGIN CONTENT -->
            <div class="page-content-wrapper">
            	 <!-- BEGIN PAGE HEAD-->
                <div class="page-head">
                    <div class="container">
                        <!-- BEGIN PAGE TITLE -->
                        <div class="page-title">
                            <h1>{{title}}</h1>
                        </div>
                        <!-- END PAGE TITLE -->
                    </div>
                </div>
                <!-- END PAGE HEAD-->
                <!-- BEGIN CONTENT BODY -->
                <!-- BEGIN PAGE CONTENT BODY -->
                <div class="page-content">
                	<div class="container">
	                    <!-- BEGIN PAGE CONTENT INNER -->
	                    <div class="page-content-inner">
	                        <div class="row">
	                            <div class="col-md-12">
	                            	<div class="portlet box sunglo">
                                        <div class="portlet-body">
                                        	<div class="row">
                                        		<div class="col-md-4"></div>
	                                        	<div class="col-md-4">
	                                        	</div>
		                                        <div class="col-md-4">
		                                        	Product:
		                                        	<select id="selected_prod" class="form-control select2" onchange="get_selected_prod();">
		                                        		<option value="all">All</option>
		                                        		{% for prod in prod_list %}
		                                        		<option value="{{prod.id}}">{{prod.name_en}}</option>
		                                        		{% endfor %}
		                                        	</select>
		                                        </div>
		                                    </div>
		                                    <br>
		                                    <div class="row">
			                                    <div class="portlet light">
			                                    	<div class="portlet-title">
			                                    		<div class="caption"><span class="caption-subject font-red-thunderbird sbold uppercase">Borrower</span></div>
			                                    	</div>
			                                    	<div class="portlet-body">
														<table class="" id="table_borrower">
															<thead>
						                                        <tr>
						                                            <th> Loan No. </th>
						                                            <th> Amount to Collect </th>
						                                            <th> Matched Percentage </th>
						                                            <th> Product </th>
						                                            <th> Application Date </th>
						                                            <th> Agreement Date </th>
						                                            <th> No. of Investors </th>
						                                        </tr>
						                                    </thead>
														</table>
													</div>
												</div>
											</div>
											<div class="row">
												<div class="portlet light">
			                                    	<div class="portlet-title">
			                                    		<div class="caption"><span class="caption-subject font-green-jungle sbold uppercase">Lender</span></div>
			                                    	</div>
			                                    	<div class="portlet-body">
														<table class="" id="table_lender">
															<thead>
						                                        <tr>
						                                            <th> Account No. </th>
						                                            <th> Investment amount </th>
						                                            <th> Matched Percentage </th>
						                                            <th> Product </th>
						                                            <th> Investment Start Date </th>
						                                            <th> Maximum Amount Per Loan </th>
						                                            <th> Reinvest </th>
						                                            <th> No. of Borrowers </th>
						                                        </tr>
						                                    </thead>
														</table>
													</div>
												</div>
											</div>
                                        </div>
                                    </div>
	                            </div>
	                        </div>
	                    </div>
                    	<!-- END PAGE CONTENT INNER -->
                    </div>
                </div>
                <!-- END PAGE CONTENT BODY -->
                <!-- END CONTENT BODY -->
            </div>
            <!-- END CONTENT -->
        </div>
        <!-- END CONTAINER -->
        <!-- BEGIN FOOTER -->
        <!-- END FOOTER -->
        <!--[if lt IE 9]>
<script src='peerloan/global/plugins/respond.min.js"></script>
<script src='peerloan/global/plugins/excanvas.min.js"></script> 
<![endif]-->
{% endlanguage %}
        <!-- BEGIN CORE PLUGINS -->
        <script src="{% static 'peerloan/global/plugins/jquery.min.js' %}" type="text/javascript"></script>
        <script src="{% static 'peerloan/global/plugins/bootstrap/js/bootstrap.min.js' %}" type="text/javascript"></script>
        <script src="{% static 'peerloan/global/plugins/js.cookie.min.js' %}" type="text/javascript"></script>
        <script src="{% static 'peerloan/global/plugins/bootstrap-hover-dropdown/bootstrap-hover-dropdown.min.js' %}" type="text/javascript"></script>
        <script src="{% static 'peerloan/global/plugins/jquery-slimscroll/jquery.slimscroll.min.js' %}" type="text/javascript"></script>
        <script src="{% static 'peerloan/global/plugins/jquery.blockui.min.js' %}" type="text/javascript"></script>
        <script src="{% static 'peerloan/global/plugins/uniform/jquery.uniform.min.js' %}" type="text/javascript"></script>
        <script src="{% static 'peerloan/global/plugins/bootstrap-switch/js/bootstrap-switch.min.js' %}" type="text/javascript"></script>
        <!-- END CORE PLUGINS -->
        <!-- BEGIN PAGE LEVEL PLUGINS -->
        <script src="{% static 'peerloan/global/plugins/bootstrap-fileinput/bootstrap-fileinput.js' %}" type="text/javascript"></script>
        
        <script src="{% static 'peerloan/global/plugins/nouislider/wNumb.min.js' %}" type="text/javascript"></script>
        <script src="{% static 'peerloan/global/plugins/ion.rangeslider/js/ion.rangeSlider.min.js' %}" type="text/javascript"></script>
        <script src="{% static 'peerloan/global/plugins/bootstrap-summernote/summernote.min.js' %}" type="text/javascript"></script>
        
        <script src="{% static 'peerloan/global/scripts/datatable.js' %}" type="text/javascript"></script>
        <script src="{% static 'peerloan/global/plugins/datatables/datatables.min.js' %}" type="text/javascript"></script>
        <script src="{% static 'peerloan/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.js' %}" type="text/javascript"></script>
        <script src="{% static 'peerloan/global/plugins/bootstrap-datepicker/js/bootstrap-datepicker.min.js' %}" type="text/javascript"></script>
        <!-- END PAGE LEVEL PLUGINS -->
        <!-- BEGIN THEME GLOBAL SCRIPTS -->
        <script src="{% static 'peerloan/global/scripts/app.min.js' %}" type="text/javascript"></script>
        <!-- END THEME GLOBAL SCRIPTS -->
        <!-- BEGIN PAGE LEVEL SCRIPTS -->
        <script src="{% static 'peerloan/pages/scripts/components-ion-sliders.min.js' %}" type="text/javascript"></script>
        <!-- END PAGE LEVEL SCRIPTS -->
        <!-- BEGIN THEME LAYOUT SCRIPTS -->
        <script src="{% static 'peerloan/layouts/layout3/scripts/layout.min.js' %}" type="text/javascript"></script>
        <script src="{% static 'peerloan/layouts/layout3/scripts/demo.min.js' %}" type="text/javascript"></script>
        <!-- END THEME LAYOUT SCRIPTS -->
<script type="text/javascript" language="javascript" class="init">

var selected_prod = document.getElementById('selected_prod').value;

function get_selected_prod(){
	selected_prod = document.getElementById('selected_prod').value;
}

function update_datatable(){
    
    var table1 = $('#table_borrower').DataTable( {
        "ajax": 
        {   "url": "/admin_bor_list_json/?data_src=fund_matching_bor"+"&prod_id="+selected_prod,
        },
        columns: [
        { "data": 'loan_no' },
        { "data": 'amount_to_collect' },
        { "data": 'matched_percentage' },
        { "data": 'prod_name' },
        { "data": 'application_date' },
        { "data": 'agreement_date' },
        { "data": 'no_of_investors' },
        ],
        "columnDefs": [ 
        	{
        		"render" : function (data, type, row) {
        			if (data != 0) {
        				return '<a href="javascript:window.open(\''+'/pl_admin/fund_matching/list_detail/?bor_ref_num='+row['loan_no']+'\',\'contestrules\', \'menubar=0,resizable=0,width=1000,height=800\');">'+data+'<a>';
	            		//return '<a href="/pl_admin/fund_matching/?list='+row['account_no']+'" target="_blank"><button class="btn green-jungle">View</button></a>'
	            	}
	            	return data
	            },
        		"targets": -1,
        	}
        ],
    } );
    
    var table2 = $('#table_lender').DataTable( {
        "ajax": 
        {   "url": "/admin_inv_list_json/?data_src=fund_matching_inv"+"&prod_id="+selected_prod,
        },
        columns: [
        { "data": 'account_no' },
        { "data": 'investment_amount' },
        { "data": 'matched_percentage' },
        { "data": 'prod_name' },
        { "data": 'investment_start_date' },
        { "data": 'max_investment_amount' },
        { "data": 'reinvest' },
        { "data": 'no_of_borrowers' },
        ],
        "columnDefs": [ 
        	{
        		"render" : function (data, type, row) {
        			if (data != 0) {
        				return '<a href="javascript:window.open(\''+'/pl_admin/fund_matching/list_detail/?inv_id='+row['inv_id']+'\',\'contestrules\', \'menubar=0,resizable=0,width=1000,height=800\');">'+data+'<a>';
	            		//return '<a href="/pl_admin/fund_matching/?list='+row['account_no']+'" target="_blank"><button class="btn green-jungle">View</button></a>'
	            	}
	            	return data
	            },
        		"targets": -1,
        	}
        ],
    } );
}

$(document).ready(function() {
      	update_datatable();
});

$('#selected_prod').change(function() {
	$("#table_borrower").dataTable().fnDestroy();
	$("#table_lender").dataTable().fnDestroy();
	update_datatable();
});
</script>
    </body>
</html>