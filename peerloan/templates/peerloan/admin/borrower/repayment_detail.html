<!DOCTYPE html><!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]--><!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]--><!--[if !IE]><!--><html lang="en">    <!-- BEGIN HEAD -->    <head>        <meta charset="utf-8" />        <title>Peerloan</title>        <meta http-equiv="X-UA-Compatible" content="IE=edge">        <meta content="width=device-width, initial-scale=1" name="viewport" />        <meta content="" name="description" />        <meta content="" name="author" />        {% load staticfiles %}        {% load my_tags %}        <script src="//code.jquery.com/jquery-1.10.2.js"></script>        <script>		$(function(){		  $("#header").load("/header/{{cate}}/{{sub_cate}}", function(){Layout.init()});		  $("#footer").load("/footer"); 		});		</script>        <!-- BEGIN GLOBAL MANDATORY STYLES -->        <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700&subset=all" rel="stylesheet" type="text/css" />        <link href="{% static 'peerloan/global/plugins/font-awesome/css/font-awesome.min.css' %}" rel="stylesheet" type="text/css" />        <link href="{% static 'peerloan/global/plugins/simple-line-icons/simple-line-icons.min.css' %}" rel="stylesheet" type="text/css" />        <link href="{% static 'peerloan/global/plugins/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet" type="text/css" />        <link href="{% static 'peerloan/global/plugins/uniform/css/uniform.default.css' %}" rel="stylesheet" type="text/css" />        <link href="{% static 'peerloan/global/plugins/bootstrap-switch/css/bootstrap-switch.min.css' %}" rel="stylesheet" type="text/css" />        <!-- END GLOBAL MANDATORY STYLES -->        <!-- BEGIN PAGE LEVEL PLUGINS -->        <link href="{% static 'peerloan/global/plugins/bootstrap-fileinput/bootstrap-fileinput.css' %}" rel="stylesheet" type="text/css" />        <link href="{% static 'peerloan/global/plugins/bootstrap-daterangepicker/daterangepicker.min.css' %}" rel="stylesheet" type="text/css" />        <link href="{% static 'peerloan/global/plugins/bootstrap-datepicker/css/bootstrap-datepicker3.min.css' %}" rel="stylesheet" type="text/css" />        <link href="{% static 'peerloan/global/plugins/bootstrap-timepicker/css/bootstrap-timepicker.min.css' %}" rel="stylesheet" type="text/css" />        <link href="{% static 'peerloan/global/plugins/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css' %}" rel="stylesheet" type="text/css" />        <link href="{% static 'peerloan/global/plugins/clockface/css/clockface.css' %}" rel="stylesheet" type="text/css" />                <link href="/static/peerloan/global/plugins/datatables/datatables.min.css" rel="stylesheet" type="text/css" />        <link href="/static/peerloan/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.css" rel="stylesheet" type="text/css" />        <!-- END PAGE LEVEL PLUGINS -->        <!-- BEGIN THEME GLOBAL STYLES -->        <link href="{% static 'peerloan/global/css/components.min.css' %}" rel="stylesheet" id="style_components" type="text/css" />        <link href="{% static 'peerloan/global/css/plugins.min.css' %}" rel="stylesheet" type="text/css" />        <!-- END THEME GLOBAL STYLES -->        <!-- BEGIN THEME LAYOUT STYLES -->        <link href="{% static 'peerloan/layouts/layout3/css/layout.css' %}" rel="stylesheet" type="text/css" />        <link href="{% static 'peerloan/layouts/layout3/css/themes/default.min.css' %}" rel="stylesheet" type="text/css" id="style_color" />        <link href="{% static 'peerloan/layouts/layout3/css/custom.min.css' %}" rel="stylesheet" type="text/css" />        <!-- END THEME LAYOUT STYLES -->        <link rel="shortcut icon" href="{% static 'favicon.ico' %}" />    </head>    <!-- END HEAD -->    <body class="page-container-bg-solid page-boxed">        <!-- BEGIN HEADER -->        <div id="header"></div>        <!-- END HEADER -->        <!-- BEGIN CONTAINER -->        <div class="page-container">            <!-- BEGIN CONTENT -->            <div class="page-content-wrapper">            	<!-- BEGIN PAGE HEAD-->                <div class="page-head">                    <div class="container">                        <!-- BEGIN PAGE TITLE -->                        <div class="page-title">                            <h1>{{title}}</h1>                        </div>                        <!-- END PAGE TITLE -->                    </div>                </div>                <!-- END PAGE HEAD-->                <!-- BEGIN CONTENT BODY -->                <!-- BEGIN PAGE CONTENT BODY -->                <div class="page-content">                    <div class="container">                        <!-- BEGIN PAGE CONTENT INNER -->                        <div class="page-content-inner">                            <div class="row">                                <div class="col-md-12">									<!-- BEGIN VALIDATION STATES-->                                    <div class="portlet light form-fit portlet-form ">                                        <div class="portlet-body">                                            <!-- BEGIN FORM PREFACE-->                                            <form validate action="/ack_admin/" class="form-horizontal form-bordered" method="post" enctype="multipart/form-data">                                            	{% csrf_token %}                                            	<div class="form-body">                                            		<a href="/pl_admin/repayment/detail/repayment_history/?bor_ref_num={{bor_ref_num}}" target="_blank"><button type="button" class="btn red-thunderbird" style="float:right;">Repayment History</button></a>                                            		<br>                                            		<h4 class="form-section">Loan Basic Information</h4>                                            		<div class="form-group">                                            			<label class="col-md-3 control-label">Loan No.:</label>                                            			<div class="col-md-3">                                            				<p class="form-control-static">{{preface.loan_no}}</p>                                            			</div>                                            			<label class="col-md-3 control-label">Due Date:</label>                                            			<div class="col-md-3">                                            				<p class="form-control-static">{{preface.due_date}}</p>                                            			</div>                                            		</div>                                            		<div class="form-group">                                            			<label class="col-md-3 control-label">Loan Amount:</label>                                            			<div class="col-md-3">                                            				<p class="form-control-static">{{preface.loan_amount}}</p>                                            			</div>                                            			<label class="col-md-3 control-label">Tenor:</label>                                            			<div class="col-md-3">                                            				<p class="form-control-static">{{preface.tenor}}</p>                                            			</div>                                            		</div>                                            		<div class="form-group">                                            			<label class="col-md-3 control-label">Name:</label>                                            			<div class="col-md-3">                                            				<p class="form-control-static">{{preface.name}}</p>                                            			</div>                                            			<label class="col-md-3 control-label">Autopay Return Reason:</label>                                            			<div class="col-md-3">                                            				<p class="form-control-static">{{preface.autopay_return_reason}}</p>                                            			</div>                                            		</div>                                            		<div class="form-group">                                            			<label class="col-md-3 control-label">Outstanding Amount:</label>                                            			<div class="col-md-3">                                            				<p class="form-control-static">{{preface.outstanding_amount}}</p>                                            			</div>                                            			<label class="col-md-3 control-label">Overdue Interest:</label>                                            			<div class="col-md-3">                                            				<p class="form-control-static">{{preface.overdue_interest}}</p>                                            			</div>                                            		</div>                                            		<div class="form-group">                                            			<label class="col-md-3 control-label">Interest Rate:</label>                                            			<div class="col-md-3">                                            				<p class="form-control-static">{{preface.interest_rate}}%</p>                                            			</div>                                            		</div>                                            		<h4 class="form-section">Overdue Repayment Records</h4>                                            			<!-- BEGIN EXAMPLE TABLE PORTLET-->					                                    <div class="portlet box red-thunderbird">					                                        <div class="portlet-title">					                                            <div class="caption"></div>					                                        </div>					                                        <div class="portlet-body">											                    <div class="">						                                            <table class="table table-striped table-hover" id="table1">						                                                <thead>									                                        <tr>									                                            <th> Tenor </th>									                                            <th> Instalment Amount </th>									                                            <th> Principal </th>									                                            <th> Interest </th>									                                            <th> Due Date </th>									                                            <th> Overdue Days </th>									                                            <th> Overdue Interest </th>									                                            <th> Late Charge </th>									                                            <th> Total </th>									                                        </tr>									                                    </thead>									                                    <tbody>													                    	{% for row in overdue_record_list %}													                        <tr>													                            <td>{{row.tenor}}</td>													                            <td>{{row.instalment}}</td>													                            <td>{{row.principal|safe}}</td>													                            <td>{{row.interest|safe}}</td>													                            <td>{{row.due_date}}</td>													                            <td>{{row.overdue_day}}</td>													                            <td>{{row.overdue_interest|safe}}</td>													                            <td>{{row.late_charge|safe}}</td>													                            <td>{{row.total|safe}}</td>													                            													                        </tr>													                        {% endfor %}													                    </tbody>						                                            </table>					                                            </div>					                                        </div>					                                    </div>					                                    <div class="well">			                                            	<div class="row static-info align-reverse">			                                            		<div class="col-md-10 name"> Early Settlement Amount </div>			                                            		<div class="col-md-2 value"> {{early_settlement_amount}} </div>			                                            	</div>			                                            	<div class="row static-info align-reverse">			                                            		<div class="col-md-10 name"> Outstanding Balance </div>			                                            		<div class="col-md-2 value"> 0.0 </div>			                                            	</div>			                                            	<div class="row static-info align-reverse">			                                            		<div class="col-md-10 name"> Over Payment Amount </div>			                                            		<div class="col-md-2 value"> {{overpay_amount}} </div>			                                            	</div><br>			                                            	<div class="row static-info align-reverse">			                                            		<div class="col-md-10 name"> Late Charge Tenor </div>			                                            		<div class="col-md-2 value"> <input class="form-control xsmall" id="Late_Charge_Tenor"> </div>			                                            	</div>			                                            	<div class="row static-info align-reverse">			                                            		<div class="col-md-10 name"> Late Charge Amount </div>			                                            		<div class="col-md-2 value"> <input class="form-control xsmall" id="Late_Charge_Amount"> </div>			                                            	</div>			                                            	<div class="row static-info align-reverse">			                                            		<div class="col-md-10 name"> </div>			                                            		<div class="col-md-2 value"> <input type="button" class="btn red-thunderbird" id="Late_Charge_Confirm" value="Confirm"> </div>			                                            	</div>			                                            </div>					                                    <!-- END EXAMPLE TABLE PORTLET-->					                                <h4 class="form-section">Borrower Repayment Submission</h4>					                                <!-- BEGIN VALIDATION STATES-->				                                    <div class="portlet box red-thunderbird ">				                                        <div class="portlet-title">				                                            <div class="caption"></div>				                                        </div>				                                        <div class="portlet-body">										                    <div class="">					                                            <table class="table table-striped table-hover" id="mytable">					                                                <thead>								                                        <tr>							                                            	<th>Submit Date</th>							                                            	<th>Type</th>							                                            	<th>Method</th>							                                            	<th>Amount</th>							                                            	<th>Uploaded Document</th>							                                            	<th>Deposit Date</th>							                                            	<th>Status</th>							                                            	<th>Confirm</th>								                                        </tr>								                                    </thead>					                                            </table>				                                            </div>				                                        </div>				                                    </div>				                                    <!-- END VALIDATION STATES-->                                            		<h4 class="form-section">Repayment</h4>                                            		<div class="form-group">                                            			<label class="col-md-3 control-label">Repayment Type:</label>                                            			<div class="col-md-4">                                            				<select class="bs-select form-control" name="Repayment Type" id="Repayment_Type" />		                            							<option value="Instalment" selected>Instalment</option>		                            							<option value="Early Settlement">Early Settlement</option>		                            						</select>                                            			</div>                                            		</div>                                            		<div class="form-group">                                            			<label class="col-md-3 control-label">Repayment Amount:</label>                                            			<div class="col-md-4">                                            				<input name="Repayment Amount" type="text" class="form-control">                                            			</div>                                            		</div>                                            		<div class="form-group">                                            			<label class="col-md-3 control-label">Repayment Method:</label>                                            			<div class="col-md-4">                                            				<select class="bs-select form-control" name="Repayment Method" />		                            							<option value="Transfer" selected>Transfer</option>		                            							<option value="Cheque">Cheque</option>		                            							<option value="Cash">Cash</option>		                            						</select>                                            			</div>                                            		</div>                                            		<div class="form-group">                                            			<label class="col-md-3 control-label">Repayment Time:</label>                                            			<div class="col-md-4">                                            				<div class="input-group date date-picker" data-date-format="yyyy/mm/dd">		                                                        <input type="text" class="form-control" name="Repayment Time" id="Repayment_Time" readonly>		                                                        <span class="input-group-btn">		                                                            <button class="btn default" type="button">		                                                                <i class="fa fa-calendar"></i>		                                                            </button>		                                                        </span>		                                                    </div>                                            			</div>                                            		</div>                                            		<div class="form-group">                                            			<label class="col-md-3 control-label">Receivable Amount:</label>                                            			<div class="col-md-4">                                            				<p class="form-control-static" id="Receivable_Amount_p">Please select repayment type and amount first.</p>                                            			</div>                                            			<div class="col-md-4">                                            				<button type="button" class="btn red-thunderbird" id="Refresh_Receivable_Amount">Refresh</button>                                            			</div>                                            		</div>                                                </div>                                                <div class="form-actions">                                                    <div class="row">                                                        <div class="col-md-offset-3 col-md-9">                                                            <button type="submit" class="btn red-thunderbird">Save</button>                                                        </div>                                                    </div>                                                </div>                                            </form>                                            <!-- END FORM PREFACE-->                                        </div>                                    </div>                                    <!-- END VALIDATION STATES-->                                </div>                            </div>                        </div>                        <!-- END PAGE CONTENT INNER -->                    </div>                </div>                <!-- END PAGE CONTENT BODY -->                <!-- END CONTENT BODY -->            </div>            <!-- END CONTENT -->        </div>        <!-- END CONTAINER -->        <!-- BEGIN FOOTER -->        <div id="footer"></div>        <!-- END FOOTER -->        <!--[if lt IE 9]><script src="../assets/global/plugins/respond.min.js"></script><script src="../assets/global/plugins/excanvas.min.js"></script> <![endif]-->        <!-- BEGIN CORE PLUGINS -->        <script src="{% static 'peerloan/global/plugins/jquery.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/bootstrap/js/bootstrap.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/js.cookie.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/bootstrap-hover-dropdown/bootstrap-hover-dropdown.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/jquery-slimscroll/jquery.slimscroll.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/jquery.blockui.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/uniform/jquery.uniform.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/bootstrap-switch/js/bootstrap-switch.min.js' %}" type="text/javascript"></script>        <!-- END CORE PLUGINS -->        <!-- BEGIN PAGE LEVEL PLUGINS -->        <script src="{% static 'peerloan/global/plugins/bootstrap-fileinput/bootstrap-fileinput.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/moment.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/bootstrap-daterangepicker/daterangepicker.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/bootstrap-datepicker/js/bootstrap-datepicker.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/bootstrap-timepicker/js/bootstrap-timepicker.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/clockface/js/clockface.js' %}" type="text/javascript"></script>        <!-- END PAGE LEVEL PLUGINS -->        <!-- BEGIN THEME GLOBAL SCRIPTS -->        <script src="{% static 'peerloan/global/scripts/app.min.js' %}" type="text/javascript"></script>        <!-- END THEME GLOBAL SCRIPTS -->        <!-- BEGIN PAGE LEVEL SCRIPTS -->        <script src="/static/peerloan/global/scripts/datatable.js" type="text/javascript"></script>        <script src="/static/peerloan/global/plugins/datatables/datatables.min.js" type="text/javascript"></script>        <script src="/static/peerloan/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.js" type="text/javascript"></script>        <script src="{% static 'peerloan/pages/scripts/components-date-time-pickers.min.js' %}" type="text/javascript"></script>        <!-- END PAGE LEVEL SCRIPTS -->        <!-- BEGIN THEME LAYOUT SCRIPTS -->        <script src="{% static 'peerloan/layouts/layout3/scripts/layout.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/layouts/layout3/scripts/demo.min.js' %}" type="text/javascript"></script>        <!-- END THEME LAYOUT SCRIPTS -->    </body><script type="text/javascript" language="javascript" class="init">$('#Refresh_Receivable_Amount').click( function() {	if (document.getElementById("Repayment_Type").value && (document.getElementById("Repayment_Time").value == '')) {				$('#Receivable_Amount_p').html('Please select repayment type and amount first.');	} else {				$.get('/calculate_repayment_amount/?bor_ref_num={{bor_ref_num}}&repayment_type='+document.getElementById("Repayment_Type").value+'&repayment_time='+document.getElementById("Repayment_Time").value, 			function(data, status){				$('#Receivable_Amount_p').html(data);			}		);	}});$('#Late_Charge_Confirm').click( function() {	$.get('/late_charge_handler/?bor_ref_num={{bor_ref_num}}&tenor='+document.getElementById("Late_Charge_Tenor").value+'&amount='+document.getElementById("Late_Charge_Amount").value,		function(data, status){			location.reload();		}	);});function update_datatable(){	    var table = $('#mytable').DataTable( {        "ajax": "/uor_list_json/?data_src=repayment&bor_ref_num={{bor_ref_num}}",        "columns": [            { data: "submit_date" },            { data: "type" },            { data: "method" },            { data: "amount" },            { data: "uploaded_doc" },            { data: "deposit_date" },            { data: "status" },            { data: "uor_id" },        ],        "columnDefs": [        	{	        	"render": function (data, type, row) {			        return '<a href="/file/'+data+'" target="_blank">View</a>';				},				"targets": 4	        },	        {	        	"render": function (data, type, row) {	        		if (row["status"] != 'PENDING APPROVAL') {			        	return '--';					} else {			        	return '<a href="javascript:;" id="confirm_yes">Yes</a>/'+'<a href="javascript:;" id="confirm_no">No</a>';					}				},				"targets": -1	        }        ],    } );}$(document).ready(function() {   update_datatable();      var table = $('#mytable').DataTable();   $('#mytable tbody').on( 'click', '#confirm_yes', function () {   		confirm_text = 'You have clicked "Yes" on this record, please confirm that you ACCEPT this operation.';    	if(confirm(confirm_text)) {	        var chq_no = $(this).closest('tr').find('#chq_no').val();	        var bank_in_date = $(this).closest('tr').find('#bank_in_date').val();			var bank_in_time = $(this).closest('tr').find('#bank_in_time').val();	        var confirm_date = $(this).closest('tr').find('#confirm_date').val();			var ptr = this;			$.ajax({		        url: '/uor_handler/?uor_id='+table.row( $(this).parents('tr') ).data().uor_id+'&confirm=True'+'&bank_in_date='+bank_in_date+		        '&bank_in_time='+bank_in_time+'&chq_no='+chq_no+'&confirm_date='+confirm_date,		        success: function(response) {		        	table.ajax.reload();		        	//$(ptr).closest("tr").fadeOut();		        }		    });	    }	        } );    $('#mytable tbody').on( 'click', '#confirm_no', function () {    	confirm_text = 'You have clicked "No" on this record, please confirm that you REJECT this operation.';    	if(confirm(confirm_text)) {    		var ptr = this;	        $.ajax({		        url: '/uor_handler/?uor_id='+table.row( $(this).parents('tr') ).data().uor_id+'&confirm=False',		        success: function(response) {		        	table.ajax.reload();		        	//$(ptr).closest("tr").fadeOut();		        }		    });		}		    } );} );</script></html>