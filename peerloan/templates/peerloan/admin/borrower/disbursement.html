<!DOCTYPE html><!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]--><!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]--><!--[if !IE]><!-->{% load i18n %}{% language lang %}<html lang="en">    <!-- BEGIN HEAD -->    <head>        <meta charset="utf-8" />        <title>{% trans "Peerloan" %}</title>        <meta http-equiv="X-UA-Compatible" content="IE=edge">        <meta content="width=device-width, initial-scale=1" name="viewport" />        <meta content="" name="description" />        <meta content="" name="author" />        {% load staticfiles %}        <script src="//code.jquery.com/jquery-1.10.2.js"></script>        <script>		$(function(){		  $("#header").load("/header/{{cate}}/{{sub_cate}}", function(){Layout.init()}); 		  $("#footer").load("/footer"); 		});		</script> 		<style>			.page-content {				background: #A23842 !important;			}		</style>        <!-- BEGIN GLOBAL MANDATORY STYLES -->        <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700&subset=all" rel="stylesheet" type="text/css" />        <link href="{% static 'peerloan/global/plugins/font-awesome/css/font-awesome.min.css' %}" rel="stylesheet" type="text/css" />        <link href="{% static 'peerloan/global/plugins/simple-line-icons/simple-line-icons.min.css' %}" rel="stylesheet" type="text/css" />        <link href="{% static 'peerloan/global/plugins/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet" type="text/css" />        <link href="{% static 'peerloan/global/plugins/uniform/css/uniform.default.css' %}" rel="stylesheet" type="text/css" />        <link href="{% static 'peerloan/global/plugins/bootstrap-switch/css/bootstrap-switch.min.css' %}" rel="stylesheet" type="text/css" />        <!-- END GLOBAL MANDATORY STYLES -->        <link href="{% static 'peerloan/global/plugins/datatables/datatables.min.css' %}" rel="stylesheet" type="text/css" />        <link href="{% static 'peerloan/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.css' %}" rel="stylesheet" type="text/css" />        <link href="{% static 'peerloan/global/plugins/bootstrap-datepicker/css/bootstrap-datepicker3.min.css' %}" rel="stylesheet" type="text/css" />        <!-- END PAGE LEVEL PLUGINS -->        <!-- BEGIN THEME GLOBAL STYLES -->        <link href="{% static 'peerloan/global/css/components.min.css' %}" rel="stylesheet" id="style_components" type="text/css" />        <link href="{% static 'peerloan/global/css/plugins.min.css' %}" rel="stylesheet" type="text/css" />        <!-- END THEME GLOBAL STYLES -->        <!-- BEGIN THEME LAYOUT STYLES -->        <link href="{% static 'peerloan/layouts/layout3/css/layout.css' %}" rel="stylesheet" type="text/css" />        <link href="{% static 'peerloan/layouts/layout3/css/themes/default.min.css' %}" rel="stylesheet" type="text/css" id="style_color" />        <link href="{% static 'peerloan/layouts/layout3/css/custom.min.css' %}" rel="stylesheet" type="text/css" />        <!-- END THEME LAYOUT STYLES -->        <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>        <link rel="shortcut icon" href="{% static 'favicon.ico' %}" />    </head>    <!-- END HEAD -->    <body class="page-container-bg-solid page-boxed">        <!-- BEGIN HEADER -->        <div id="header"></div>        <!-- END HEADER -->        <!-- BEGIN CONTAINER -->        <div class="page-container">            <!-- BEGIN CONTENT -->            <div class="page-content-wrapper">            	 <!-- BEGIN PAGE HEAD-->                <div class="page-head">                    <div class="container">                        <!-- BEGIN PAGE TITLE -->                        <div class="page-title">                            <h1>{{title}}</h1>                        </div>                        <!-- END PAGE TITLE -->                    </div>                </div>                <!-- END PAGE HEAD-->                <!-- BEGIN CONTENT BODY -->                <!-- BEGIN PAGE CONTENT BODY -->                <div class="page-content">                	<div class="container">	                    <!-- BEGIN PAGE CONTENT INNER -->	                    <div class="page-content-inner">	                        <div class="row">	                            <div class="col-md-12">	                            	<div class="portlet light portlet-fit portlet-form ">                                        <div class="portlet-body">                                        	<div class="row">                                        		<div class="col-md-4"></div>                                        		<div class="col-md-4"></div>	                                        	<div class="col-md-4">	                                        		Product: 	                                        		<select id="selected_product" class="form-control select2" onchange="get_selected_product();">		                                        		<option value="all">All</option>		                                        		{% for prod in prod_list %}		                                        		<option value="{{prod.id}}">{{prod.name_en}}</option>		                                        		{% endfor %}		                                        	</select>	                                        	</div>		                                    </div>		                                    <br>											<table class="" id="table1">												<thead>			                                        <tr>			                                            <th> Application No. </th>			                                            <th> Name </th>			                                            <th> Amount ($) </th>			                                            <th> Product Type </th>			                                            <th> Confirmed Identity </th>			                                            <th> Last Updated Time<br>(DD/MM/YYYY) </th>			                                            <th> Disbursement Method </th>			                                            <th> State </th>			                                            <th> Activate Button </th>			                                        </tr>			                                    </thead>											</table>											                                        </div>                                    </div>	                            </div>	                        </div>	                    </div>                    	<!-- END PAGE CONTENT INNER -->                    </div>                </div>                <!-- END PAGE CONTENT BODY -->                <!-- END CONTENT BODY -->            </div>            <!-- END CONTENT -->        </div>        <!-- END CONTAINER -->        <!-- BEGIN FOOTER -->        <!-- END FOOTER -->        <!--[if lt IE 9]><script src='peerloan/global/plugins/respond.min.js"></script><script src='peerloan/global/plugins/excanvas.min.js"></script> <![endif]-->{% endlanguage %}        <!-- BEGIN CORE PLUGINS -->        <script src="{% static 'peerloan/global/plugins/jquery.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/bootstrap/js/bootstrap.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/js.cookie.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/bootstrap-hover-dropdown/bootstrap-hover-dropdown.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/jquery-slimscroll/jquery.slimscroll.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/jquery.blockui.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/uniform/jquery.uniform.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/bootstrap-switch/js/bootstrap-switch.min.js' %}" type="text/javascript"></script>        <!-- END CORE PLUGINS -->        <!-- BEGIN PAGE LEVEL PLUGINS -->        <script src="{% static 'peerloan/global/plugins/bootstrap-fileinput/bootstrap-fileinput.js' %}" type="text/javascript"></script>                <script src="{% static 'peerloan/global/plugins/nouislider/wNumb.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/ion.rangeslider/js/ion.rangeSlider.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/bootstrap-summernote/summernote.min.js' %}" type="text/javascript"></script>                <script src="{% static 'peerloan/global/scripts/datatable.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/datatables/datatables.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/global/plugins/bootstrap-datepicker/js/bootstrap-datepicker.min.js' %}" type="text/javascript"></script>        <!-- END PAGE LEVEL PLUGINS -->        <!-- BEGIN THEME GLOBAL SCRIPTS -->        <script src="{% static 'peerloan/global/scripts/app.min.js' %}" type="text/javascript"></script>        <!-- END THEME GLOBAL SCRIPTS -->        <!-- BEGIN PAGE LEVEL SCRIPTS -->        <script src="{% static 'peerloan/pages/scripts/components-ion-sliders.min.js' %}" type="text/javascript"></script>        <!-- END PAGE LEVEL SCRIPTS -->        <!-- BEGIN THEME LAYOUT SCRIPTS -->        <script src="{% static 'peerloan/layouts/layout3/scripts/layout.min.js' %}" type="text/javascript"></script>        <script src="{% static 'peerloan/layouts/layout3/scripts/demo.min.js' %}" type="text/javascript"></script>        <!-- END THEME LAYOUT SCRIPTS --><script type="text/javascript" language="javascript" class="init">var selected_product = document.getElementById('selected_product').value;function get_selected_product(){	selected_product = document.getElementById('selected_product').value;}function update_datatable(){        var table = $('#table1').DataTable( {        "ajax":         {   "url": "/admin_bor_list_json/?cate=disbursement&prod_id="+selected_product+'&status=all',        },        columns: [        { "data": 'application_no' },        { "data": 'name' },        { "data": 'amount' },        { "data": 'prod_type' },        { "data": 'confirmed_identity' },        { "data": 'last_updated_time' },        { "data": 'disbursement_method' },        { "data": 'state' },        { "data": 'application_no' },        ],        "fnRowCallback": function( nRow, aData, iDisplayIndex) {        	if (aData['ptn_status'] == 'UNREAD') {        		$('td', nRow).each(function(){        			$(nRow).css('font-weight', 'bold');        		});        	}        	return nRow;        },        "columnDefs": [        	{	            "render" : function (data, type, row) {	            	return '<a href="/pl_admin/application/detail/?bor_ref_num='+data+'" target="_blank">'+data+'</a>'	            },	            "targets": 0	        },	        {	        	"render": function (data, type, row) {			        return '<button class="btn red-thunderbird" ref-num="'+data+'" id="confirm">Confirm</button>';				},				"targets": -1	        }        ],    } );}function bind_onclick_action(){	var table = $('#table1').DataTable();	$('#table1 tbody').on('click', '#confirm', function(){		var ref_num = $(this).attr('ref-num')		confirm_text = 'You have pressed confirm on '+ref_num+', please press OK to ACCEPT this operation.';		if(confirm(confirm_text)) {			$.ajax({				url:'/bor_handler/?bor_ref_num='+ref_num+'&action=disburse',				success: function(response) {					alert(response);					$("#table1").dataTable().fnDestroy();					update_datatable();				}			});		}		var status = table.row( $(this).closest('tr') ).data()['ptn_status'];    	if (status == 'UNREAD') {	    	var bor_id = table.row( $(this).closest('tr') ).data()['bor_id'];	    	$.ajax({	    		url: '/ptn_handler/?bor_id='+bor_id,	    		success: function(response) {	    			table.ajax.reload();	    			$("#header").load("/header/{{cate}}/{{sub_cate}}", function(){Layout.init()}); 	    		}	    	});    	}	});}$(document).ready(function() {	update_datatable();	bind_onclick_action();});$('#selected_product').change(function() {	$("#table1").dataTable().fnDestroy();	update_datatable();	//bind_onclick_action();});</script>    </body></html>